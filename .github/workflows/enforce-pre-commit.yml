name: ğŸ”’ Enforce Pre-Commit

on:
  pull_request:
  push:
    branches: [main, develop]

jobs:
  pre-commit:
    name: Pre-commit Checks
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4

      - name: ğŸ Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.12"

      - name: â™»ï¸ Cache pre-commit
        uses: actions/cache@v4
        with:
          path: ~/.cache/pre-commit
          key: pre-commit-${{ runner.os }}-${{ hashFiles('.pre-commit-config.yaml') }}

      - name: ğŸ“¦ Install pre-commit
        run: pip install --upgrade pre-commit

      - name: ğŸ” Run pre-commit (ENFORCED)
        run: |
          if [ ! -f .pre-commit-config.yaml ]; then
            echo "âŒ .pre-commit-config.yaml missing â€“ enforcement enabled."
            exit 1
          fi

          pre-commit run --all-files --show-diff-on-failure
